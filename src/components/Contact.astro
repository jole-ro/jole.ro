---
const { lang = "en" } = Astro.props;

const content = {
  en: {
    title: "Enhance Your Local Digital Presence",
    name: "Business Name (Optional)",
    person: "Name",
    email: "Email (Optional)",
    phone: "Phone (Optional)",
    message: "How can we help?",
    send: "Send Message",
    sending: "Sending...",
    success: "Thank you for your message. We'll get back to you soon!",
    error: "Failed to send message. Please try again.",
    privacyPath: "/privacy",
    privacy: "Privacy Policy",
    consent: "I agree to the processing of my personal data according to the",
    benefits: [
      {
        icon: "ğŸ¯",
        title: "Expert Strategy",
        desc: "Receive a tailored growth plan designed to make your business easy for local customers to find.",
      },
      {
        icon: "âš¡",
        title: "Fast Response",
        desc: "We respect your time and guarantee a professional reply to your message within 24 hours.",
      },
      {
        icon: "ğŸ”",
        title: "No-Obligation Audit",
        desc: "Claim a free AI-driven check to see how your current local presence appears to customers.",
      },
      {
        icon: "ğŸ› ï¸",
        title: "Practical Results",
        desc: "We focus on clear, effective optimizations that help your business stand out in search results.",
      },
    ],
  },
  hu: {
    title: "JavÃ­tsa helyi digitÃ¡lis jelenlÃ©tÃ©t",
    name: "CÃ©g (OpcionÃ¡lis)",
    person: "NÃ©v",
    email: "Email (OpcionÃ¡lis)",
    phone: "TelefonszÃ¡m (OpcionÃ¡lis)",
    message: "Hogyan segÃ­thetÃ¼nk?",
    send: "Ãœzenet KÃ¼ldÃ©se",
    sending: "KÃ¼ldÃ©s...",
    success: "KÃ¶szÃ¶njÃ¼k az Ã¼zenetet. Hamarosan vÃ¡laszolunk!",
    error: "Nem sikerÃ¼lt elkÃ¼ldeni az Ã¼zenetet. KÃ©rjÃ¼k, prÃ³bÃ¡lja Ãºjra.",
    privacyPath: "/hu/privacy",
    privacy: "adatkezelÃ©si tÃ¡jÃ©koztatÃ³ban",
    consent: "HozzÃ¡jÃ¡rulok a szemÃ©lyes adataim kezelÃ©sÃ©hez az",
    benefits: [
      {
        icon: "ğŸ¯",
        title: "SzakÃ©rtÅ‘i StratÃ©gia",
        desc: "Testreszabott nÃ¶vekedÃ©si tervet kap, amellyel vÃ¡llalkozÃ¡sa kÃ¶nnyen megtalÃ¡lhatÃ³ lesz a helyi Ã¼gyfelek szÃ¡mÃ¡ra.",
      },
      {
        icon: "âš¡",
        title: "Gyors VÃ¡lasz",
        desc: "TiszteljÃ¼k az idejÃ©t, Ã©s garantÃ¡ljuk a profeszionÃ¡lis vÃ¡laszt Ã¼zenetÃ©re 24 Ã³rÃ¡n belÃ¼l.",
      },
      {
        icon: "ğŸ”",
        title: "KÃ¶telezettsÃ©gmentes Audit",
        desc: "Ingyenes, AI-alapÃº ellenÅ‘rzÃ©s a jelenlegi helyi jelenlÃ©tÃ©rÅ‘l.",
      },
      {
        icon: "ğŸ› ï¸",
        title: "Gyakorlati EredmÃ©nyek",
        desc: "VilÃ¡gos, hatÃ©kony optimalizÃ¡lÃ¡sokra Ã¶sszpontosÃ­tunk, amelyek segÃ­tik vÃ¡llalkozÃ¡sÃ¡t a keresÃ©si eredmÃ©nyekben.",
      },
    ],
  },
  ro: {
    title: "ÃmbunÄƒtÄƒÈ›iÈ›i-vÄƒ prezenÈ›a digitalÄƒ localÄƒ",
    name: "Numele Afacerii (OpÈ›ional)",
    person: "Nume",
    email: "Email (OpÈ›ional)",
    phone: "Telefon (OpÈ›ional)",
    message: "Cum vÄƒ putem ajuta?",
    send: "Trimite Mesaj",
    sending: "Se trimite...",
    success: "VÄƒ mulÈ›umim pentru mesaj. VÄƒ vom rÄƒspunde Ã®n curÃ¢nd!",
    error: "Trimiterea mesajului a eÈ™uat. VÄƒ rugÄƒm sÄƒ Ã®ncercaÈ›i din nou.",
    privacyPath: "/ro/privacy",
    privacy: "politica de confidenÈ›ialitate",
    consent: "Sunt de acord cu prelucrarea datelor mele personale conform",
    benefits: [
      {
        icon: "ğŸ¯",
        title: "Strategie de Expert",
        desc: "PrimiÈ›i un plan de creÈ™tere personalizat, conceput pentru a face afacerea dvs. uÈ™or de gÄƒsit de cÄƒtre clienÈ›ii locali.",
      },
      {
        icon: "âš¡",
        title: "RÄƒspuns Rapid",
        desc: "VÄƒ respectÄƒm timpul È™i garantÄƒm un rÄƒspuns profesional la mesajul dvs. Ã®n termen de 24 de ore.",
      },
      {
        icon: "ğŸ”",
        title: "Audit fÄƒrÄƒ ObligaÈ›ii",
        desc: "SolicitaÈ›i o verificare gratuitÄƒ bazatÄƒ pe AI pentru a vedea cum apare prezenÈ›a dvs. localÄƒ actualÄƒ clienÈ›ilor.",
      },
      {
        icon: "ğŸ› ï¸",
        title: "Rezultate Practice",
        desc: "Ne concentrÄƒm pe optimizÄƒri clare È™i eficiente care ajutÄƒ afacerea dvs. sÄƒ iasÄƒ Ã®n evidenÈ›Äƒ Ã®n rezultatele cÄƒutÄƒrii.",
      },
    ],
  },
};

const t = content[lang as keyof typeof content] || content.en;
---

<section id="contact" class="py-24 bg-gray-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900">{t.title}</h2>
    </div>

    <div class="grid lg:grid-cols-5 gap-12 items-start">
      <!-- Contact Form -->
      <div class="lg:col-span-3">
        <form class="bg-white p-8 rounded-2xl shadow-sm border border-gray-100">
          <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >{t.person}</label
              >
              <input
                type="text"
                name="name"
                class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-shadow"
                required
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >{t.name}</label
              >
              <input
                type="text"
                name="businessName"
                class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-shadow"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >{t.email}</label
              >
              <input
                type="email"
                id="contact-email"
                name="email"
                class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-shadow"
              />
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2"
                >{t.phone}</label
              >
              <input
                type="tel"
                id="contact-phone"
                name="phone"
                class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-shadow"
              />
            </div>
          </div>
          <div class="mb-6">
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >{t.message}</label
            >
            <textarea
              name="message"
              class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-shadow"
              rows="4"
              required></textarea>
          </div>

          <div class="mb-8 flex items-start gap-3">
            <input
              type="checkbox"
              id="gdpr-consent"
              name="consent"
              value="true"
              required
              class="mt-1 w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary cursor-pointer"
            />
            <label
              for="gdpr-consent"
              class="text-sm text-gray-600 leading-tight"
            >
              {t.consent}
              <a
                href={t.privacyPath}
                class="text-primary hover:underline font-medium">{t.privacy}</a
              >.
            </label>
          </div>

          <button
            type="submit"
            id="submit-btn"
            class="w-full bg-primary text-white py-4 rounded-xl hover:bg-primary-hover cursor-pointer font-semibold shadow-lg shadow-primary/20 transition-all hover:-translate-y-1 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <span id="submit-text">{t.send}</span>
          </button>
        </form>
      </div>

      <!-- Sidebar Benefits -->
      <div class="lg:col-span-2 space-y-8">
        {
          t.benefits.map((benefit) => (
            <div class="flex gap-4">
              <div class="flex-shrink-0 w-12 h-12 bg-white rounded-xl shadow-sm border border-gray-100 flex items-center justify-center text-2xl">
                {benefit.icon}
              </div>
              <div>
                <h3 class="text-lg font-bold text-gray-900 mb-1">
                  {benefit.title}
                </h3>
                <p class="text-gray-600 leading-relaxed text-sm">
                  {benefit.desc}
                </p>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>

<script>
  const form = document.querySelector("form");
  const submitBtn = document.getElementById("submit-btn") as HTMLButtonElement;
  const submitText = document.getElementById("submit-text");

  if (form && submitBtn && submitText) {
    form.addEventListener("submit", async function (e) {
      e.preventDefault();

      const emailInput = document.getElementById(
        "contact-email",
      ) as HTMLInputElement;
      const phoneInput = document.getElementById(
        "contact-phone",
      ) as HTMLInputElement;

      // Check if at least email or phone is provided
      if (!emailInput.value && !phoneInput.value) {
        alert(
          document.documentElement.lang === "hu"
            ? "KÃ©rjÃ¼k, adja meg az e-mail cÃ­mÃ©t vagy a telefonszÃ¡mÃ¡t!"
            : document.documentElement.lang === "ro"
              ? "VÄƒ rugÄƒm sÄƒ furnizaÈ›i o adresÄƒ de e-mail sau un numÄƒr de telefon!"
              : "Please provide either an email or a phone number!",
        );
        return;
      }

      // Disable submit button and show loading state
      submitBtn.disabled = true;
      const originalText = submitText.textContent;
      submitText.textContent =
        document.documentElement.lang === "hu"
          ? "KÃ¼ldÃ©s..."
          : document.documentElement.lang === "ro"
            ? "Se trimite..."
            : "Sending...";

      try {
        const formData = new FormData(form);
        const data = Object.fromEntries(formData);

        const response = await fetch("https://submit-form.com/41PA1XYWP", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Accept: "application/json",
          },
          body: JSON.stringify(data),
        });

        if (response.ok) {
          // Show success message
          const successMessage = document.createElement("div");
          successMessage.className =
            "fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded shadow-lg z-50";
          successMessage.textContent =
            document.documentElement.lang === "hu"
              ? "KÃ¶szÃ¶njÃ¼k az Ã¼zenetet. Hamarosan vÃ¡laszolunk!"
              : document.documentElement.lang === "ro"
                ? "VÄƒ mulÈ›umim pentru mesaj. VÄƒ vom rÄƒspunde Ã®n curÃ¢nd!"
                : "Thank you for your message. We'll get back to you soon!";
          document.body.appendChild(successMessage);

          setTimeout(() => {
            successMessage.remove();
          }, 5000);

          form.reset();
        } else {
          throw new Error("Failed to send message");
        }
      } catch (error) {
        // Show error message
        const errorMessage = document.createElement("div");
        errorMessage.className =
          "fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded shadow-lg z-50";
        errorMessage.textContent =
          document.documentElement.lang === "hu"
            ? "Nem sikerÃ¼lt elkÃ¼ldeni az Ã¼zenetet. KÃ©rjÃ¼k, prÃ³bÃ¡lja Ãºjra."
            : document.documentElement.lang === "ro"
              ? "Trimiterea mesajului a eÈ™uat. VÄƒ rugÄƒm sÄƒ Ã®ncercaÈ›i din nou."
              : "Failed to send message. Please try again.";
        document.body.appendChild(errorMessage);

        setTimeout(() => {
          errorMessage.remove();
        }, 5000);

        console.error("Form submission error:", error);
      } finally {
        // Re-enable submit button
        submitBtn.disabled = false;
        submitText.textContent = originalText;
      }
    });
  }
</script>
